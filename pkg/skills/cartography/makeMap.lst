C:\pol2\pkg\skills\cartography\makeMap.src, Line 9
var mapdefs := array(
0: decl global #0
1: array
2: array
3: 0L
4: +=
5: "Vesper"
6: +=
7: 2636L
8: +=
9: 592L
10: +=
11: 3064L
12: +=
13: 1012L
14: +=
15: 200L
16: +=
17: 200L
18: +=
19: +=
20: array
21: 1L
22: +=
23: "Yew"
24: +=
25: 236L
26: +=
27: 741L
28: +=
29: 766L
30: +=
31: 1269L
32: +=
33: 200L
34: +=
35: 200L
36: +=
37: +=
38: array
39: 2L
40: +=
41: "Skara Brae"
42: +=
43: 524L
44: +=
45: 2064L
46: +=
47: 960L
48: +=
49: 2452L
50: +=
51: 200L
52: +=
53: 200L
54: +=
55: +=
56: array
57: 3L
58: +=
59: "Jhelom"
60: +=
61: 1088L
62: +=
63: 3572L
64: +=
65: 1528L
66: +=
67: 4056L
68: +=
69: 200L
70: +=
71: 200L
72: +=
73: +=
74: array
75: 4L
76: +=
77: "Trinsic"
78: +=
79: 1792L
80: +=
81: 2630L
82: +=
83: 2118L
84: +=
85: 2952L
86: +=
87: 200L
88: +=
89: 200L
90: +=
91: +=
92: array
93: 5L
94: +=
95: "Minoc"
96: +=
97: 2360L
98: +=
99: 356L
100: +=
101: 2706L
102: +=
103: 702L
104: +=
105: 200L
106: +=
107: 200L
108: +=
109: +=
110: array
111: 6L
112: +=
113: "Bucaneer's Den"
114: +=
115: 2616L
116: +=
117: 2072L
118: +=
119: 2767L
120: +=
121: 2263L
122: +=
123: 200L
124: +=
125: 200L
126: +=
127: +=
128: array
129: 7L
130: +=
131: "Serpent's Hold"
132: +=
133: 2714L
134: +=
135: 3329L
136: +=
137: 3100L
138: +=
139: 3639L
140: +=
141: 200L
142: +=
143: 200L
144: +=
145: +=
146: array
147: 8L
148: +=
149: "Nujelm"
150: +=
151: 3446L
152: +=
153: 1030L
154: +=
155: 3832L
156: +=
157: 1424L
158: +=
159: 200L
160: +=
161: 200L
162: +=
163: +=
164: array
165: 9L
166: +=
167: "Magincia"
168: +=
169: 3530L
170: +=
171: 2022L
172: +=
173: 3818L
174: +=
175: 2298L
176: +=
177: 200L
178: +=
179: 200L
180: +=
181: +=
182: array
183: 10L
184: +=
185: "Ocllo"
186: +=
187: 3582L
188: +=
189: 2456L
190: +=
191: 3770L
192: +=
193: 2742L
194: +=
195: 200L
196: +=
197: 200L
198: +=
199: +=
200: array
201: 11L
202: +=
203: "Moonglow"
204: +=
205: 4156L
206: +=
207: 808L
208: +=
209: 4732L
210: +=
211: 1528L
212: +=
213: 200L
214: +=
215: 200L
216: +=
217: +=
218: array
219: 12L
220: +=
221: "Britain"
222: +=
223: 1092L
224: +=
225: 1396L
226: +=
227: 1736L
228: +=
229: 1924L
230: +=
231: 200L
232: +=
233: 200L
234: +=
235: +=
236: array
237: 13L
238: +=
239: "Minoc to Yew"
240: +=
241: 0L
242: +=
243: 256L
244: +=
245: 2304L
246: +=
247: 3072L
248: +=
249: 200L
250: +=
251: 200L
252: +=
253: +=
254: array
255: 14L
256: +=
257: "Minoc to Vesper"
258: +=
259: 2467L
260: +=
261: 572L
262: +=
263: 2878L
264: +=
265: 746L
266: +=
267: 200L
268: +=
269: 200L
270: +=
271: +=
272: array
273: 15L
274: +=
275: "Britain to Trinsic"
276: +=
277: 1024L
278: +=
279: 1280L
280: +=
281: 2304L
282: +=
283: 3072L
284: +=
285: 200L
286: +=
287: 200L
288: +=
289: +=
290: array
291: 16L
292: +=
293: "Trinsic to Bucaneer's Den"
294: +=
295: 1792L
296: +=
297: 1792L
298: +=
299: 3072L
300: +=
301: 3072L
302: +=
303: 200L
304: +=
305: 200L
306: +=
307: +=
308: array
309: 17L
310: +=
311: "Bucaneer's Den to Ocllo"
312: +=
313: 2560L
314: +=
315: 1792L
316: +=
317: 3840L
318: +=
319: 3072L
320: +=
321: 200L
322: +=
323: 200L
324: +=
325: +=
326: array
327: 18L
328: +=
329: "Trinsic to Jhelom"
330: +=
331: 256L
332: +=
333: 1792L
334: +=
335: 2304L
336: +=
337: 4095L
338: +=
339: 200L
340: +=
341: 200L
342: +=
343: +=
344: array
345: 19L
346: +=
347: "Vesper to Nujelm"
348: +=
349: 2636L
350: +=
351: 592L
352: +=
353: 3840L
354: +=
355: 1536L
356: +=
357: 200L
358: +=
359: 200L
360: +=
361: +=
362: array
363: 20L
364: +=
365: "Nujelm to Magincia"
366: +=
367: 3328L
368: +=
369: 1024L
370: +=
371: 3840L
372: +=
373: 2304L
374: +=
375: 200L
376: +=
377: 200L
378: +=
379: +=
380: array
381: 21L
382: +=
383: "Bucaneer's Den to Magincia"
384: +=
385: 2560L
386: +=
387: 1792L
388: +=
389: 3840L
390: +=
391: 2560L
392: +=
393: 200L
394: +=
395: 200L
396: +=
397: +=
398: array
399: 22L
400: +=
401: "Magincia to Ocllo"
402: +=
403: 3328L
404: +=
405: 1792L
406: +=
407: 3840L
408: +=
409: 2304L
410: +=
411: 200L
412: +=
413: 200L
414: +=
415: +=
416: array
417: 23L
418: +=
419: "Serpent's Hold to Ocllo"
420: +=
421: 2560L
422: +=
423: 2560L
424: +=
425: 3840L
426: +=
427: 3840L
428: +=
429: 200L
430: +=
431: 200L
432: +=
433: +=
434: array
435: 24L
436: +=
437: "Moonglow to Nujelm"
438: +=
439: 3328L
440: +=
441: 768L
442: +=
443: 4864L
444: +=
445: 1536L
446: +=
447: 200L
448: +=
449: 200L
450: +=
451: +=
452: array
453: 25L
454: +=
455: "Yew to Britain"
456: +=
457: 0L
458: +=
459: 512L
460: +=
461: 1792L
462: +=
463: 2048L
464: +=
465: 200L
466: +=
467: 200L
468: +=
469: +=
470: array
471: 26L
472: +=
473: "Britain to Skara Brae"
474: +=
475: 256L
476: +=
477: 1792L
478: +=
479: 1736L
480: +=
481: 2560L
482: +=
483: 200L
484: +=
485: 200L
486: +=
487: +=
488: array
489: 27L
490: +=
491: "the World"
492: +=
493: 0L
494: +=
495: 0L
496: +=
497: 5199L
498: +=
499: 4095L
500: +=
501: 200L
502: +=
503: 200L
504: +=
505: +=
506: :=
507: #
C:\pol2\pkg\skills\cartography\makeMap.src, Line 41
program makemap( who, mapitem )
508: get arg 'who'
509: get arg 'mapitem'
if(!ReserveItem(mapitem))
510: local #1
511: Func(2,0): ReserveItem
512: if true goto 515
return;
513: ""
514: progend
if(GetObjProperty(mapitem, "maplevel"))
515: local #1
516: "maplevel"
517: Func(2,1): GetObjProperty
518: if false goto 527
SendSysMessage(who, "You cannot inscribe a trasure map");
519: local #0
520: "You cannot inscribe a trasure map"
521: 3L
522: 1000L
523: Func(2,2): SendSysMessage
524: #
return;
525: ""
526: progend
var mapname := cint(GetObjProperty( mapitem, "maptype"));
527: decl local #2
528: local #1
529: "maptype"
530: Func(2,1): GetObjProperty
531: Func(0,0): CInt
532: :=
533: #
foreach mapdef in mapdefs
534: global #0
535: initforeach @555
if (mapdef[1] == mapname)
536: local #3
537: 1L
538: [] 1
539: local #2
540: ==
541: if false goto 555
makethemap( who, mapdef );
542: local #0
543: local #3
544: makelocal
545: jmp userfunc @559
546: #
releaseitem(mapitem);
547: local #1
548: Func(2,3): ReleaseItem
549: #
DestroyItem (mapitem);
550: local #1
551: Func(2,4): DestroyItem
552: #
return;
553: ""
554: progend
555: stepforeach @536
556: leave block(3)
557: leave block(3)
558: progend
C:\pol2\pkg\skills\cartography\makeMap.src, Line 59
function makethemap( who, mapdef )
559: pop param 'mapdef'
560: pop param 'who'
var map := CreateItemInBackpack( who, UOBJ_MAP1 );
561: decl local #2
562: local #1
563: 5355L
564: 1L
565: Func(2,5): CreateItemInBackpack
566: :=
567: #
map.name := "map of " + mapdef[2];
568: local #2
569: "map of "
570: local #0
571: 2L
572: [] 1
573: +
574: set member 'name' #
map.xwest := hex(mapdef[3]);
575: local #2
576: local #0
577: 3L
578: [] 1
579: Func(0,1): Hex
580: set member 'xwest' #
map.ynorth := hex(mapdef[4]);
581: local #2
582: local #0
583: 4L
584: [] 1
585: Func(0,1): Hex
586: set member 'ynorth' #
map.xeast := hex(mapdef[5]);
587: local #2
588: local #0
589: 5L
590: [] 1
591: Func(0,1): Hex
592: set member 'xeast' #
map.ysouth := hex(mapdef[6]);
593: local #2
594: local #0
595: 6L
596: [] 1
597: Func(0,1): Hex
598: set member 'ysouth' #
map.gumpwidth := hex(mapdef[7]);
599: local #2
600: local #0
601: 7L
602: [] 1
603: Func(0,1): Hex
604: set member 'gumpwidth' #
map.gumpheight := hex(mapdef[8]);
605: local #2
606: local #0
607: 8L
608: [] 1
609: Func(0,1): Hex
610: set member 'gumpheight' #
611: 0L
612: return
